@model Inventory.Models.ViewModels.ReceiptReportVM
@{
    ViewBag.Title = Labels.ReceiptReport;
    Layout = "~/Views/Shared/_Layout.cshtml";
    var _user = ViewBag.AppUser as Inventory.Models.ViewModels.UserWithRole;
}
<div class="margin-bottom-10">
    @if (_user.HasAccess("ReceiptReportMem7", "Search"))
    {
        <a href="@Url.Action("Search")" class="btn btn-sm">@Labels.back_to_list</a>
    }
    @if (_user.HasAccess("ReceiptReportMem7", "Edit"))
    {
        <a href="@Url.Action("Edit", new { id = 1 })" class="btn btn-sm blue"><i class="fa fa-edit"></i> @Labels.edit</a>
    }
    @if (_user.HasAccess("ReceiptReportMem7", "Print"))
    {
        <a href="@Url.Action("Print", new { id = 1 })" class="btn btn-sm btn-success" id="btn_print"><i class="fa fa-print"></i> @Labels.print_preview</a>
    }
    @if (_user.HasAccess("ReceiptReportMem7", "Delete"))
    {
        <a href="@Url.Action("Delete", new { id = 1 })" class="btn btn-sm btn-danger" id="btn_delete"><i class="fa fa-trash"></i> @Labels.delete</a>
    }
</div>

<div id="print_area">
    <div style="direction:rtl;">
        <table border="1" class="table table-striped table-condensed table-bordered" style="border-collapse: collapse; width:100%;">
            <thead>
                <tr>
                    <td colspan="9">
                        <table style="width:100%">
                            <thead>
                                <tr>
                                    <th colspan="3" style="text-align:right; border-right:none;">@Labels.Mem7Form</th>
                                    <th colspan="6" style="text-align:right; border-right:none;">@Labels.ReceiptReport</th>
                                </tr>
                            </thead>
                        </table>
                    </td>
                </tr>
                <tr>
                    <th colspan="2" style="text-align:right; word-wrap:normal;">@Labels.ReportNumber</th>
                    <th colspan="2" style="text-align:right; word-wrap:normal;">@Model.ReportNumber</th>
                    <th colspan="2" style="text-align:right; word-wrap:normal;">@Labels.organization</th>
                    <th colspan="3" style="text-align:right; word-wrap:normal;">@Model.Organization</th>

                </tr>
                <tr>
                    <th colspan="2" style="text-align:right; word-wrap:normal;">@Labels.date</th>
                    <th colspan="2" style="text-align:right; word-wrap:normal;">@Model.ReceiptDateVM</th>
                    <th colspan="2" style="text-align:right; word-wrap:normal;">@Labels.DeliveryPlace</th>
                    <th colspan="3" style="text-align:right; word-wrap:normal;">@Model.DeliveryPlace</th>

                </tr>
                <tr>
                    <th colspan="2" style="text-align:right; word-wrap:normal; width:20%">@Labels.SuggestionBillNumber </th>
                    <th colspan="2" style="text-align:right; word-wrap:normal;">@Model.SuggBillNumber</th>
                    <th colspan="2" style="text-align:right; word-wrap:normal;">@Labels.ObtainedFromContractor</th>
                    <th colspan="3" style="text-align:right; word-wrap:normal;">@Model.ObtainedFromContractor</th>
                </tr>
                <tr>
                    <th colspan="2" style="text-align:right; word-wrap:normal;">@Labels.Mem3Date</th>
                    <th colspan="7" style="text-align:right; word-wrap:normal;">@Model.Mem3DateVM</th>

                </tr>
                <tr>
                    <th style="text-align:center; word-wrap:normal; word-wrap:normal;  width:5%;">@Labels.Quantity</th>
                    <th style="text-align:center; word-wrap:normal;word-wrap:normal;  width:10%;">@Labels.Unit</th>
                    <th colspan="3" style="text-align:center; word-wrap:normal; width:40%;">@Labels.ItemDetails</th>
                    <th style="text-align:center; word-wrap:normal;word-wrap:normal;  width:10%;">@Labels.UnitPrice</th>
                    <th style="text-align:center; word-wrap:normal;word-wrap:normal;  width:15%;">@Labels.TotalPrice</th>
                    <th colspan="2" style="text-align:center; word-wrap:normal; width:20%;">@Labels.Remarks</th>
                </tr>
                <tr>
                    <th style="text-align:center;">۷</th>
                    <th style="text-align:center;">۸</th>
                    <th colspan="3" style="text-align:center;">۹</th>
                    <th style="text-align:center;">۱۰</th>
                    <th style="text-align:center;">۱۱</th>
                    <th colspan="2" style="text-align:center;">۱۲</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model.ReceiptReportItems)
                {
                    <tr>
                        <th>@item.Quantity</th>
                        <th>@item.UnitName</th>
                        <th colspan="3">@item.ItemDetails</th>
                        <th>@item.UnitPrice</th>
                        <th>@item.TotalPrice</th>
                        <th colspan="2">@item.Remarks</th>
                    </tr>

                }
                <tr>
                    <th style="text-align:center; word-wrap:normal;">&nbsp;</th>
                    <th style="text-align:center; word-wrap:normal;">&nbsp;</th>
                    <th colspan="3" style="text-align:center; word-wrap:normal; width:40%;">@Model.Details</th>
                    <th style="text-align:center; word-wrap:normal;">&nbsp;</th>
                    <th style="text-align:center; word-wrap:normal;">&nbsp;</th>
                    <th colspan="2" style="text-align:center; word-wrap:normal;">&nbsp;</th>
                </tr>
                <tr>
                    <th style="text-align:center;"></th>
                    <th style="text-align:center;"></th>
                    <th colspan="3" style="text-align:center;"> ۱۳ مجموع قیمت</th>
                    <th style="text-align:center;">&nbsp;</th>
                    <th style="text-align:center;">@Model.ReceiptReportItems.Sum(i=>i.TotalPrice)</th>
                    <th colspan="2" style="text-align:center;">افغانی </th>
                </tr>
            </tbody>
            <tfoot>
                <tr>
                    <td colspan="9" style="text-align:center;">
                        <p><b>تثدیق مشخص تسلیم شویده</b> </p>
                        <p> تصدیق میدارم که اجناس یا خدمات فوق الذکر راتسلیم شدم اجناس مذکور رابه غور وزن حساب یا اندازه  فورم خدمات مذکور قناعت بحش واجناس آن به استثنای اقلامیکه درستون ملاحظات ذکر شده مکمل وسالم بوده </p>

                    </td>
                </tr>
                <tr>
                    <th colspan="2" style="padding-top:15px; padding-bottom:15px; text-align:'center right';"> محل امضاء ۱۴ </th>
                    <th colspan="2"></th>
                    <th colspan="2" style="padding-top:15px; padding-bottom:15px; text-align:'center right';"> هویت ۱۵</th>
                    <th colspan="3"></th>
                </tr>
            </tfoot>

        </table>
    </div>
</div>
@section scripts{
    <script type="text/javascript">
        $(function () {
            $('body').on('click', '#btn_delete', function (e) {
                e.preventDefault();
                var url = $(this).attr('href');
                bootbox.confirm('@Labels.are_you_sure', function (result) {
                    if (result == true) {
                        $.get(url, function (response) {
                            if (response == true) {
                                window.location.href = '@Url.Action("Search")';
                            }
                        })
                    }
                })
            })
            $('body').on('click', '#btn_print', function (e) {
                e.preventDefault();
                var divToPrint = $("#print_area").html();
                var newWin = window.open("");
                newWin.document.write(divToPrint);
                newWin.print();
                newWin.close();
            })
        })
    </script>
}